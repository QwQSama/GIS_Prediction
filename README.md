
# 项目 README

## 项目概述

本项目的目标是通过各种环境特征预测户外降温系统的温度，采用的主要模型包括 **MLP（多层感知器）** 和 **LSTM（长短期记忆网络）**。同时，项目支持数据集的三种划分方法：**随机划分**、**均匀间隔划分** 和 **滑动窗口划分**。该项目包括数据预处理、异常值剔除、标准化处理，并能够处理不同格式的数据。

本项目的核心任务是基于历史数据，使用特征如湿度、云底高度、辐射等预测温度。

## 特性
- **数据预处理**：
  - 处理缺失值并使用 Z-score 进行异常值剔除。
  - 标准化特征数据，并保存标准化参数，确保后续数据一致性处理。

- **模型训练**：
  - **MLP**：用于作为基线模型的简单全连接神经网络。
  - **LSTM**：处理时间序列数据的高级模型，用于捕获序列依赖关系。

- **数据集划分**：
  - **随机划分**：将数据随机划分为训练集、验证集和测试集。
  - **均匀间隔划分**：根据时间间隔均匀划分数据。
  - **滑动窗口划分**：按时间顺序划分，测试集紧跟训练集。

## 安装依赖

请确保你已经安装了以下依赖：

```
pandas
numpy
scikit-learn
torch
joblib
matplotlib
scipy
```

## 文件结构

```
project/
├── data/                    # 数据文件夹，包含不同数据划分方法的子文件夹
│   ├── random_split/
│   ├── uniform_split/
│   └── time_split/
├── model/                   # 模型架构文件
│   ├── mlp_model.py
│   ├── lstm_model.py
│   └── __init__.py
├── train/                   # 训练脚本
│   ├── train_mlp.py         # 训练 MLP 模型的脚本
│   └── train_lstm.py        # 训练 LSTM 模型的脚本
├── test/                    # 测试脚本
│   ├── test_mlp.py          # 测试 MLP 模型的脚本
│   └── test_lstm.py         # 测试 LSTM 模型的脚本
├── utils/                   # 工具函数（数据处理、异常值剔除等）
│   └── data_process.py
└── README.md                
```

## 使用说明

### 1. 数据预处理

首先，我们需要处理原始数据。`data_process.py` 脚本完成以下任务：

- 加载原始数据（如 `gisdata_qwq.xlsx`）。
- 删除空列和含有缺失值的行。
- 将对象类型的列转换为数值型。
- 使用 Z-score 剔除异常值。
- 将数据分割为三种不同的划分方式（随机划分、均匀间隔划分、滑动窗口划分）。
- 标准化特征数据并保存标准化参数，供以后使用。

运行以下命令进行数据预处理：

```bash
cd data
python data_process.py
```

该命令会创建三个子文件夹（`random_split`、`uniform_split` 和 `time_split`），并在每个文件夹中保存处理后的数据和对应的标准化参数。

### 2. 模型训练

数据处理完成后，我们可以开始训练模型。

#### 训练 MLP 模型：

使用以下命令训练 MLP 模型：

```bash
cd train
python train_mlp.py
```

该命令会：
- 加载预处理后的数据。
- 训练 MLP 模型，隐藏层节点数为 128，层数为 50。
- 将训练后的模型和损失图保存到对应文件夹。

#### 训练 LSTM 模型：

使用以下命令训练 LSTM 模型：

```bash
cd train
python train_lstm.py
```

该命令会：
- 加载预处理后的数据。
- 训练 LSTM 模型，序列长度默认为 10。
- 将训练后的模型和损失图保存到对应文件夹。

### 3. 测试模型

一旦模型训练完成，我们可以在测试数据集上评估模型。

#### 测试 MLP 模型：

使用以下命令测试 MLP 模型：

```bash
python test/test_mlp.py
```

#### 测试 LSTM 模型：

使用以下命令测试 LSTM 模型：

```bash
python test/test_lstm.py
```

测试脚本会：
- 加载训练好的模型和测试数据。
- 计算评估指标（MSE、MAE、RMSE）。
- 保存结果、预测数据，并生成真实值与预测值的对比图。

### 4. 后续开发（使用 Transformer 模型）

为了提高性能，下一步可以尝试使用 **Transformer 模型**，它在处理时间序列数据时可以捕捉长期依赖关系。
